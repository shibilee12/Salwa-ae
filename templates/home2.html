{% extends 'base.html' %}
{% load static %}

{% block title %}Salwa AE | Feel the Reality{% endblock %}

{% block extra_css %}
<style>
  /* Text Reveal Styles */
  .reveal-text {
    overflow: hidden;
    perspective: 1000px;
  }

  .char {
    display: inline-block;
    will-change: transform;
  }

  /* Magnetic Button Support */
  .magnetic-btn {
    display: inline-block;
    transition: transform 0.1s;
  }

  /* Hero Section Overrides */
  .hero-section {
    min-height: 100vh;
    min-height: 100dvh;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
  }

  .hero-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: -1;
    filter: brightness(0.4);
    clip-path: circle(0% at 50% 50%);
  }

  .hero-title {
    font-size: clamp(5rem, 18vw, 15rem);
    font-weight: 900;
    line-height: 0.8;
    margin-bottom: 2rem;
    letter-spacing: -0.06em;
    perspective: 2000px;
    -webkit-text-stroke: 1px rgba(255, 255, 255, 0.3);
    color: transparent;
    transition: all 0.5s ease;
  }

  .hero-title .kinetic-word span {
    display: inline-block;
    color: white;
    -webkit-text-stroke: 0;
  }

  /* God-Tier Gradient Text */
  .text-luxury {
    background: linear-gradient(135deg, #fff 30%, var(--salwa-gold) 100%);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  /* Liquid Displacement Overlays */
  .liquid-overlay {
    position: fixed;
    inset: 0;
    z-index: 40;
    background: #000;
    clip-path: polygon(0 0, 100% 0, 100% 0, 0 0);
    pointer-events: none;
    filter: url(#liquid-filter);
  }

  /* Glass Slider Effect */
  .glass-slider {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.02);
    backdrop-filter: blur(40px);
    z-index: 50;
    transform: translateX(-100%);
    pointer-events: none;
  }

  /* Career Section Styles */
  .career-card {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 30px;
    padding: 3rem;
    transition: all 0.6s cubic-bezier(0.19, 1, 0.22, 1);
    position: relative;
    overflow: hidden;
  }

  .career-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, transparent, rgba(212, 175, 55, 0.1), transparent);
    transform: translateX(-100%);
    transition: transform 0.8s ease;
  }

  .career-card:hover::before {
    transform: translateX(100%);
  }

  .career-card:hover {
    border-color: var(--salwa-gold);
    transform: translateY(-10px) scale(1.02);
    background: rgba(255, 255, 255, 0.05);
  }

  .hero-subtitle {
    font-size: 1.2rem;
    letter-spacing: 0.5em;
    text-transform: uppercase;
    color: var(--salwa-gold);
    margin-bottom: 2rem;
  }

  .division-card {
    background: rgba(255, 255, 255, 0.02);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 24px;
    padding: clamp(1.25rem, 4vw, 3.5rem);
    transition: border-color 0.4s ease;
    position: relative;
    overflow: hidden;
    height: auto;
    min-height: 320px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
  }

  .division-card:hover {
    border-color: var(--salwa-gold);
  }

  .division-card h3 {
    font-size: clamp(1.4rem, 3.2vw, 2.2rem);
    margin-bottom: 1.2rem;
    font-weight: 600;
    z-index: 2;
  }

  .division-card p {
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.95rem;
    line-height: 1.6;
    z-index: 2;
  }

  .division-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 1;
    opacity: 0.15;
    transition: all 0.8s cubic-bezier(0.19, 1, 0.22, 1);
    transform: scale(1.1);
  }

  .division-card:hover .division-bg {
    opacity: 0.35;
    transform: scale(1);
  }

  .scroll-indicator {
    position: absolute;
    bottom: 3rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: 10;
    opacity: 0.6;
  }

  .luxury-btn {
    background: var(--salwa-gold);
    color: #000;
    text-transform: uppercase;
    letter-spacing: 0.15em;
    font-size: 0.7rem;
    font-weight: 700;
    padding: 1.2rem 2.5rem;
    border-radius: 99px;
    transition: all 0.4s cubic-bezier(0.19, 1, 0.22, 1);
    display: inline-block;
    text-align: center;
  }

  .luxury-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 30px rgba(212, 175, 55, 0.3);
    filter: brightness(1.1);
  }

  .glass {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.05);
  }

  @media (max-width: 640px) {
    .hero-subtitle {
      letter-spacing: 0.35em;
      font-size: 0.95rem;
    }

    .scroll-indicator {
      bottom: 1.5rem;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="liquid-overlay" id="displacement-wipe"></div>
<div class="glass-slider"></div>

<section class="hero-section min-h-screen flex items-center justify-center relative overflow-hidden">
  <div class="hero-distort absolute inset-0 z-0"></div>
  <video autoplay muted loop playsinline preload="metadata" class="hero-bg hero-bg-parallax"
    poster="https://images.unsplash.com/photo-1503376780353-7e6692767b70?auto=format&fit=crop&w=1920&q=80">
    <source src="{% static 'videos/hero_bg.mp4' %}" type="video/mp4">
  </video>
  <!-- God-Tier Fallback Image if Video/Source fails -->
  <img src="https://images.unsplash.com/photo-1503376780353-7e6692767b70?auto=format&fit=crop&w=1920&q=80"
    alt="Salwa Hero Fallback" class="hero-bg hero-bg-parallax" style="z-index: -2">
  <div class="hero-overlay absolute inset-0 bg-black/50"></div>

  <div class="hero-content px-4 text-center">
    <div class="reveal-text mb-6">
      <p class="hero-subtitle !mb-0 opacity-0 entrance-up tracking-[1em] text-xs">PHASE 03 // BEYOND REALITY</p>
    </div>
    <h1 class="hero-title text-white">
      <span class="block kinetic-word overflow-hidden"><span
          class="block translate-y-full opacity-0">SALWA</span></span>
      <span class="block kinetic-word overflow-hidden text-luxury"><span
          class="block translate-y-full opacity-0">GROUP</span></span>
    </h1>
    <div class="mt-16 opacity-0 entrance-up flex flex-col items-center gap-6" style="transition-delay: 1.2s">
      <a href="#divisions" class="luxury-btn !px-16 !py-8 !text-sm !tracking-[0.8em]">INITIATE PROTOCOL</a>
      <div class="flex items-center gap-4 text-[0.6rem] uppercase tracking-[0.4em] opacity-30">
        <span>Dubai</span>
        <span class="w-1 h-1 bg-white rounded-full"></span>
        <span>Abu Dhabi</span>
        <span class="w-1 h-1 bg-white rounded-full"></span>
        <span>Global</span>
      </div>
    </div>
  </div>

  <div class="scroll-indicator animate-bounce">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
    </svg>
  </div>
</section>

<section id="divisions" class="py-20 sm:py-28 md:py-32 max-w-7xl mx-auto px-4 sm:px-6 relative">
  <div class="mb-16">
    <h2 class="text-4xl font-bold mb-4 brand-font">OUR <span style="color: var(--salwa-gold)">DIVISIONS</span></h2>
    <div class="w-20 h-1 bg-gold"></div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
    <!-- Salwa Studio -->
    <a href="{% url 'business' 'studio' %}" class="division-card">
      <img src="{% static 'logos/salwastudio.jpeg' %}" alt="Salwa Studio" class="division-bg">
      <div class="division-card-content">
        <h3 class="brand-font">Salwa Studio</h3>
        <p>Advanced creative intelligence and design thinking.</p>
      </div>
    </a>

    <!-- Salwa Cafe -->
    <a href="{% url 'business' 'cafe' %}" class="division-card">
      <img src="{% static 'logos/salwacafe.jpeg' %}" alt="Salwa Cafe" class="division-bg">
      <div class="division-card-content">
        <h3 class="brand-font">Salwa Cafe</h3>
        <p>A curated sanctuary where luxury gastronomy meets social intelligence.</p>
      </div>
    </a>

    <!-- Salwa Bookshop -->
    <a href="{% url 'business' 'bookshop' %}" class="division-card">
      <img src="{% static 'logos/salwabookshop.jpeg' %}" alt="Salwa Bookshop" class="division-bg">
      <div class="division-card-content">
        <h3 class="brand-font">Salwa Bookshop</h3>
        <p>A repository of knowledge for the next era. Curating minds.</p>
      </div>
    </a>

    <!-- Salwa Perfumes -->
    <a href="{% url 'business' 'perfumes' %}" class="division-card">
      <img src="https://images.unsplash.com/photo-1541643600914-78b084683601?auto=format&fit=crop&w=800&q=80"
        alt="Salwa Perfumes" class="division-bg">
      <div class="division-card-content">
        <h3 class="brand-font">Salwa Perfumes</h3>
        <p>Rare olfactory narratives that redefine boundaries.</p>
      </div>
    </a>

    <!-- Salwa Electricals -->
    <a href="{% url 'business' 'electricals' %}" class="division-card">
      <img src="{% static 'logos/salwaelectricals.jpeg' %}" alt="Salwa Electricals" class="division-bg">
      <div class="division-card-content">
        <h3 class="brand-font">Salwa Electricals</h3>
        <p>Intelligent power solutions for an interconnected future.</p>
      </div>
    </a>
  </div>
</section>

<!-- NEW: Careers Teaser Section -->
<section class="py-20 sm:py-28 md:py-40 bg-black relative overflow-hidden">
  <div class="max-w-7xl mx-auto px-4 sm:px-6">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
      <div class="scroll-reveal">
        <p class="gold tracking-[0.5em] text-xs uppercase mb-4">The Future is Salwa</p>
        <h2 class="text-5xl md:text-7xl font-bold mb-8 brand-font leading-tight">JOIN THE<br><span
            style="color: var(--salwa-gold)">EVOLUTION</span></h2>
        <p class="text-gray-400 text-lg mb-12 leading-relaxed max-w-lg">
          We don't just hire employees; we recruit visionaries ready to define the future of UAE's creative and
          industrial landscape.
        </p>
        <a href="{% url 'careers' %}" class="luxury-btn !px-16">View Vacancies</a>
      </div>
      <div class="grid grid-cols-2 gap-6">
        <div class="career-card mt-12 hover-tilt">
          <div class="text-gold text-sm mb-4">01</div>
          <h4 class="text-xl font-bold mb-2">Creatives</h4>
          <p class="text-xs text-gray-500">Studios & Design Intelligence</p>
        </div>
        <div class="career-card hover-tilt">
          <div class="text-gold text-sm mb-4">02</div>
          <h4 class="text-xl font-bold mb-2">Artisans</h4>
          <p class="text-xs text-gray-500">Culinary & Olfactory Crafts</p>
        </div>
        <div class="career-card mt-12 hover-tilt">
          <div class="text-gold text-sm mb-4">03</div>
          <h4 class="text-xl font-bold mb-2">Strategists</h4>
          <p class="text-xs text-gray-500">Operations & Growth</p>
        </div>
        <div class="career-card hover-tilt">
          <div class="text-gold text-sm mb-4">04</div>
          <h4 class="text-xl font-bold mb-2">Engineers</h4>
          <p class="text-xs text-gray-500">Infrastructure & Energy</p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="py-20 sm:py-28 md:py-32 bg-black/50 backdrop-blur-md relative overflow-hidden border-t border-white/5">
  <div class="max-w-7xl mx-auto px-4 sm:px-6">
    <div class="mb-16">
      <h2 class="text-4xl font-bold mb-4 brand-font">CURATED <span style="color: var(--salwa-gold)">KNOWLEDGE</span>
      </h2>
      <div class="w-20 h-1 bg-gold"></div>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
      <!-- Book 5 -->
      <div class="glass p-6 rounded-[1.5rem] group hover:border-gold/40 transition-all duration-500">
        <div class="aspect-[3/4] rounded-[1rem] overflow-hidden mb-6 relative">
          <img src="{% static 'books/jessica-fadel-qXuMWgoga6Q-unsplash.jpg' %}" alt="Minimalism"
            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
          <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-60">
          </div>
        </div>
        <h6 class="brand text-xl mb-1 group-hover:gold transition-colors">Essence of Luxury</h6>
        <p class="text-gray-500 text-xs uppercase tracking-widest mb-4">J. Fadel • Curated</p>
        <a href="{% url 'business' 'bookshop' %}" class="luxury-btn w-full !rounded-xl">Acquire Knowledge</a>
      </div>

      <!-- Book 6 -->
      <div class="glass p-6 rounded-[1.5rem] group hover:border-gold/40 transition-all duration-500">
        <div class="aspect-[3/4] rounded-[1rem] overflow-hidden mb-6 relative">
          <img src="{% static 'books/sincerely-media-CXYPfveiuis-unsplash.jpg' %}" alt="Media Theory"
            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
          <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-60">
          </div>
        </div>
        <h6 class="brand text-xl mb-1 group-hover:gold transition-colors">Narrative Structures</h6>
        <p class="text-gray-500 text-xs uppercase tracking-widest mb-4">Sincerely Media • Vol 04</p>
        <button class="luxury-btn w-full !rounded-xl">Acquire Knowledge</button>
      </div>

      <!-- Book 7 -->
      <div class="glass p-6 rounded-[1.5rem] group hover:border-gold/40 transition-all duration-500">
        <div class="aspect-[3/4] rounded-[1rem] overflow-hidden mb-6 relative">
          <img src="{% static 'books/toa-heftiba-ip9R11FMbV8-unsplash.jpg' %}" alt="Philosophy"
            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
          <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-60">
          </div>
        </div>
        <h6 class="brand text-xl mb-1 group-hover:gold transition-colors">Beyond the Binary</h6>
        <p class="text-gray-500 text-xs uppercase tracking-widest mb-4">T. Heftiba • Theory</p>
        <button class="luxury-btn w-full !rounded-xl">Acquire Knowledge</button>
      </div>

      <!-- Book 8 -->
      <div class="glass p-6 rounded-[1.5rem] group hover:border-gold/40 transition-all duration-500">
        <div class="aspect-[3/4] rounded-[1rem] overflow-hidden mb-6 relative">
          <img src="{% static 'books/zoe-1nYWu8_s3dE-unsplash.jpg' %}" alt="Photography"
            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
          <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-60">
          </div>
        </div>
        <h6 class="brand text-xl mb-1 group-hover:gold transition-colors">Visual Lexicon</h6>
        <p class="text-gray-500 text-xs uppercase tracking-widest mb-4">Zoe • Masterpiece</p>
        <a href="{% url 'business' 'bookshop' %}" class="luxury-btn w-full !rounded-xl">Acquire Knowledge</a>
      </div>
    </div>
  </div>
</section>

<!-- RESTORED: Portfolio Modal (Accidentally removed) -->
<div id="portfolioModal"
  class="fixed inset-0 z-[100] hidden flex items-center justify-center bg-black/95 backdrop-blur-3xl opacity-0 transition-opacity duration-500 p-2 sm:p-4">
  <div class="absolute top-4 right-4 flex items-center gap-4 z-[110]">
    <button type="button" id="closePortfolio"
      class="viewer-close text-white text-4xl hover:text-gold transition-colors">✕</button>
  </div>
  <div class="relative w-full max-w-[95vw] h-[85dvh] rounded-xl overflow-hidden border border-gold/40 shadow-2xl">
    <img src="{% static 'studio/studio.jpg.jpeg' %}" alt="Portfolio Full" class="w-full h-full object-contain">
  </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
  // Advanced Animation Utilities
  const ScrambleText = {
    chars: 'ABCDEFHIJKLMNOPQRSTUVWXYZ1234567890@#$%&',
    scramble(el, text, duration = 1.5) {
      let iteration = 0;
      const interval = setInterval(() => {
        el.innerText = text.split("").map((letter, index) => {
          if (index < iteration) return text[index];
          return this.chars[Math.floor(Math.random() * this.chars.length)];
        }).join("");

        if (iteration >= text.length) clearInterval(interval);
        iteration += text.length / (duration * 60);
      }, 30);
    }
  };

  document.addEventListener('DOMContentLoaded', () => {
    // 0. Reality Distortion Entrance (Liquid Wipe)
    const godTl = gsap.timeline();

    // Initial Liquid Wipe
    godTl.to("#displacement-wipe", {
      clipPath: "polygon(0 0, 100% 0, 100% 100%, 0 100%)",
      duration: 1.5,
      ease: "power4.inOut"
    })
      .to("#displacement-wipe", {
        clipPath: "polygon(0 100%, 100% 100%, 100% 100%, 0 100%)",
        duration: 1.5,
        ease: "power4.inOut"
      })
      // Liquid Mask Reveal for Hero BG
      .to(".hero-bg", {
        clipPath: "circle(100% at 50% 50%)",
        duration: 2.5,
        ease: "expo.inOut"
      }, "-=1")
      // Kinetic Typography Stagger
      .to(".kinetic-word span", {
        y: 0,
        opacity: 1,
        duration: 1.8,
        stagger: 0.3,
        ease: "expo.out"
      }, "-=1.5")
      .to(".entrance-up", {
        y: 0,
        opacity: 1,
        duration: 1.5,
        stagger: 0.2,
        ease: "expo.out"
      }, "-=1");

    // 1. Liquid Transition Shaders (SVG Displacement)
    gsap.utils.toArray('section').forEach((section, i) => {
      if (i === 0) return;

      ScrollTrigger.create({
        trigger: section,
        start: "top 90%",
        onEnter: () => {
          gsap.timeline()
            .to("#displacement-wipe", { clipPath: "polygon(0 0, 100% 0, 100% 100%, 0 100%)", duration: 0.6, ease: "power2.inOut" })
            .to("#displacement-wipe", { clipPath: "polygon(0 100%, 100% 100%, 100% 100%, 0 100%)", duration: 0.8, ease: "power3.inOut" })
            .set("#displacement-wipe", { clipPath: "polygon(0 0, 100% 0, 100% 0, 0 0)" });
        }
      });
    });

    // 2. Mouse-Reactive Distortion Hero
    const heroDistort = document.querySelector('.hero-distort');
    if (heroDistort) {
      document.addEventListener('mousemove', (e) => {
        const x = (e.clientX / window.innerWidth - 0.5) * 40;
        const y = (e.clientY / window.innerHeight - 0.5) * 40;
        gsap.to(".hero-title", {
          x: x * 0.5,
          y: y * 0.5,
          rotateY: x * 0.2,
          rotateX: -y * 0.2,
          duration: 1,
          ease: "power2.out"
        });
      });
    }

    // 3. Magnetic & Tilt Refinements
    const magneticElements = document.querySelectorAll('.luxury-btn, .division-card, .career-card');
    magneticElements.forEach(btn => {
      btn.addEventListener('mousemove', (e) => {
        const rect = btn.getBoundingClientRect();
        const x = (e.clientX - rect.left - rect.width / 2) * 0.1;
        const y = (e.clientY - rect.top - rect.height / 2) * 0.1;
        gsap.to(btn, { x, y, duration: 0.4, ease: 'power2.out' });
      });
      btn.addEventListener('mouseleave', () => {
        gsap.to(btn, { x: 0, y: 0, duration: 0.6, ease: 'elastic.out(1, 0.3)' });
      });
    });

    // 4. Scroll Reveal with Distortion
    gsap.utils.toArray('.scroll-reveal, .division-card').forEach(el => {
      gsap.from(el, {
        scrollTrigger: { trigger: el, start: "top 90%" },
        y: 100,
        opacity: 0,
        filter: "blur(20px) url(#liquid-filter)",
        duration: 2,
        ease: "expo.out"
      });
    });

    // 5. Text Scramble Elite
    const scrambleElements = document.querySelectorAll('.brand-font');
    scrambleElements.forEach(el => {
      ScrollTrigger.create({
        trigger: el,
        start: "top 95%",
        onEnter: () => {
          if (!el.dataset.scrambled) {
            if (typeof ScrambleText !== 'undefined') {
              ScrambleText.scramble(el, el.innerText);
              el.dataset.scrambled = "true";
            }
          }
        }
      });
    });
  });
</script>
{% endblock %}